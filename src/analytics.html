<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Phishing & Smishing Analytics</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f8f9fa; }
  header { background: #1f2937; color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
  .logo { display: flex; align-items: center; gap: 10px; }
  .logo img { height: 40px; width: 40px; }
  .logo h1 { margin: 0; font-size: 1.4rem; }
  .subtitle { font-size: 0.8rem; color: #d1d5db; }
  nav { display: flex; gap: 0.8rem; }
  .nav-btn { background: transparent; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; transition: background 0.2s; }
  .nav-btn:hover { background: #374151; }
  .nav-btn.active { background: #2563eb; }
  .container { max-width: 1200px; margin: auto; padding: 2rem; }
  .filters { display: flex; gap: 1rem; margin-bottom: 1rem; align-items: center; }
  select, button { padding: 0.5rem; border-radius: 6px; border: 1px solid #ccc; cursor: pointer; }
  .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
  .stat { background: white; padding: 1.5rem; border-radius: 12px; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.08); transition: transform 0.2s ease; }
  .stat:hover { transform: translateY(-4px); }
  .stat h3 { margin: 0; font-size: 2rem; color: #1f2937; }
  .charts, .reports, .campaigns { background: white; padding: 2rem; margin-bottom: 2rem; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); }
  .charts canvas { width: 100% !important; height: 400px !important; }
  table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
  table th, table td { padding: 0.75rem; border: 1px solid #e5e7eb; text-align: left; }
  table th { background: #f1f5f9; }
  .btn { display: inline-block; padding: 0.6rem 1.2rem; border-radius: 6px; background: #1f2937; color: white; border: none; cursor: pointer; font-size: 0.95rem; }
  .btn:hover { background: #374151; }
  .report-item { padding: 1rem; border: 1px solid #ddd; margin-top: 1rem; border-radius: 6px; background: #f9fafb; }
  .alert { color: red; font-weight: bold; }
</style>
</head>
<body>
<header>
  <div class="logo">
    <img src="/public/socialguard.png" alt="SocialGuard Logo">
    <div>
      <h1>SocialGuard</h1>
      <span class="subtitle">Social Engineering Attack Simulator</span>
    </div>
  </div>
  <nav>
    <button class="nav-btn" onclick="location.href='index.html'">Home</button>
    <button class="nav-btn">Attack Library</button>
    <button class="nav-btn">Add Workers</button>
    <button class="nav-btn">Simulation Builder</button>
    <button class="nav-btn">Training</button>
    <button class="nav-btn active">Analytics</button>
    <button class="nav-btn">Reports</button>
    <button class="nav-btn">Logout</button>
  </nav>
</header>

<div class="container">
  <!-- Mode Toggle -->
  <div style="margin-bottom: 1rem;">
    <button class="btn" id="modeHistorical">Historical Analytics</button>
    <button class="btn" id="modeRealtime">Realtime Monitoring</button>
  </div>

  <!-- Filters -->
  <div class="filters" id="filterSection">
    <label>Campaign:
      <select id="campaignFilter"><option>Loading...</option></select>
    </label>
    <label>Time:
      <select id="timeFilter">
        <option value="7">Last 7 days</option>
        <option value="30">Last 30 days</option>
        <option value="all" selected>All Time</option>
      </select>
    </label>
    <button class="btn" onclick="simulator.updateDashboardMetrics()">Apply Filters</button>
  </div>

  <!-- Historical Section -->
  <div id="historicalSection">
    <section class="stats">
      <div class="stat"><h3 id="stat-sent">0</h3><p>Total Sent</p></div>
      <div class="stat"><h3 id="stat-opened">0</h3><p>Opened</p></div>
      <div class="stat"><h3 id="stat-clicked">0</h3><p>Clicked</p></div>
      <div class="stat"><h3 id="stat-creds">0</h3><p>Credentials Submitted</p></div>
      <div class="stat"><h3 id="stat-reported">0</h3><p>Reported</p></div>
    </section>

    <section class="charts">
      <h2>Engagement Trends</h2>
      <canvas id="improvementChart"></canvas>
      
      <h2>Conversion Funnel</h2>
      <canvas id="funnelChart"></canvas>

      <h2>Engagement Heatmap (by Hour)</h2>
      <canvas id="heatmapChart"></canvas>

      <h2>Department Analytics</h2>
      <canvas id="departmentChart"></canvas>

      <h2>Device Distribution</h2>
      <canvas id="deviceChart"></canvas>

      <h2>Comparative Metrics</h2>
      <canvas id="comparativeChart"></canvas>
    </section>

    <section class="campaigns">
      <h2>Top Campaigns by Click Rate</h2>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Start</th>
            <th>End</th>
            <th>Click %</th>
            <th>Alert</th>
          </tr>
        </thead>
        <tbody id="campaigns-body"></tbody>
      </table>
    </section>

    <section class="reports">
      <h2>Reports</h2>
      <select id="reportType">
        <option value="executive">Executive</option>
        <option value="detailed">Detailed</option>
      </select>
      <button class="btn" onclick="simulator.generatePDF()">Generate & Download PDF</button>
      <div id="reportList"></div>
    </section>
  </div>

  <!-- Realtime Section -->
  <div id="realtimeSection" style="display:none;">
    <section class="stats">
      <div class="stat"><h3 id="rt-stat-sent">0</h3><p>Total Sent</p></div>
      <div class="stat"><h3 id="rt-stat-opened">0</h3><p>Opened</p></div>
      <div class="stat"><h3 id="rt-stat-clicked">0</h3><p>Clicked</p></div>
      <div class="stat"><h3 id="rt-stat-reported">0</h3><p>Reported</p></div>
    </section>

    <section class="charts">
      <h2>Realtime Engagement</h2>
      <canvas id="realtimeChart"></canvas>
    </section>
  </div>
</div>

<script type="module" src="./dash.js"></script>
  

</body>
</html>
  